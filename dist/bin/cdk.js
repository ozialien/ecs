#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("aws-cdk-lib");
const ecs_service_stack_1 = require("../lib/ecs-service-stack");
/**
 * CDK App Entry Point
 *
 * Uses CDK's native context parameters (-c) for configuration
 *
 * Usage:
 *   # Context parameters only
 *   cdk deploy -c vpcId=vpc-12345678 -c image=nginx:alpine
 *
 *   # With values file (Helm-style)
 *   cdk deploy -c valuesFile=values.yaml
 */
const app = new cdk.App();
// Start with empty config
let config = {};
// 1. Load from values file FIRST if specified
const valuesFile = app.node.tryGetContext('valuesFile');
if (valuesFile) {
    const fs = require('fs');
    const path = require('path');
    if (fs.existsSync(valuesFile)) {
        try {
            const fileContent = fs.readFileSync(valuesFile, 'utf8');
            const ext = path.extname(valuesFile).toLowerCase();
            let values;
            try {
                switch (ext) {
                    case '.js':
                        values = require(path.resolve(valuesFile));
                        break;
                    case '.yaml':
                    case '.yml':
                        const yaml = require('js-yaml');
                        values = yaml.load(fileContent);
                        break;
                    default:
                        values = JSON.parse(fileContent);
                }
            }
            catch (error) {
                console.error(`‚ùå Error parsing values file ${valuesFile}: ${error}`);
                process.exit(1);
            }
            // Load values file into config
            config = { ...config, ...values };
            console.log(`üìÑ Loaded values from: ${valuesFile}`);
        }
        catch (error) {
            console.warn(`‚ö†Ô∏è  Warning: Failed to parse values file ${valuesFile}: ${error}`);
        }
    }
    else {
        console.warn(`‚ö†Ô∏è  Warning: Values file not found: ${valuesFile}`);
    }
}
// 2. Override with context parameters (highest precedence)
// Only override if the context parameter actually exists
const contextKeys = [
    // Legacy flat parameters (backward compatibility)
    'vpcId', 'subnetIds', 'clusterName', 'image', 'stackName', 'desiredCount',
    'cpu', 'memory', 'containerPort', 'lbPort', 'healthCheckPath', 'loadBalancerHealthCheck', 'allowedCidr',
    'env', 'secret', 'logGroupName', 'logRetentionDays', 'enableAutoScaling',
    'minCapacity', 'maxCapacity', 'targetCpuUtilization', 'targetMemoryUtilization',
    'taskExecutionRoleArn', 'taskRoleArn', 'taskRolePermissions', 'taskExecutionRolePermissions',
    // New structured parameters (ECS hierarchy)
    'metadata', 'infrastructure', 'cluster', 'taskDefinition', 'service', 'loadBalancer', 'autoScaling', 'iam', 'serviceDiscovery', 'addons'
];
contextKeys.forEach(key => {
    const contextValue = app.node.tryGetContext(key);
    if (contextValue !== undefined) {
        // Handle special cases
        if (key === 'subnetIds' && typeof contextValue === 'string') {
            config.subnetIds = contextValue.split(',');
        }
        else if (key === 'env') {
            config.environment = contextValue;
        }
        else if (key === 'secret') {
            config.secrets = contextValue;
        }
        else if (key === 'metadata' || key === 'infrastructure' || key === 'cluster' ||
            key === 'taskDefinition' || key === 'service' || key === 'loadBalancer' ||
            key === 'autoScaling' || key === 'iam' || key === 'serviceDiscovery' || key === 'addons') {
            // New structured parameters - these will be handled by the config mapper
            config[key] = contextValue;
        }
        else {
            // Legacy flat parameters
            config[key] = contextValue;
        }
    }
});
// 3. Fall back to environment variables (lowest precedence)
// Apply environment variable fallbacks directly to config
config.vpcId = config.vpcId || process.env.VPC_ID || '';
config.subnetIds = config.subnetIds || process.env.SUBNET_IDS?.split(',') || [];
config.clusterName = config.clusterName || process.env.CLUSTER_NAME || '';
config.image = config.image || process.env.IMAGE || '';
config.stackName = config.stackName || process.env.STACK_NAME || '';
config.desiredCount = config.desiredCount || parseInt(process.env.DESIRED_COUNT || '1');
config.cpu = config.cpu || parseInt(process.env.CPU || '256');
config.memory = config.memory || parseInt(process.env.MEMORY || '512');
config.containerPort = config.containerPort || parseInt(process.env.CONTAINER_PORT || '');
config.lbPort = config.lbPort || parseInt(process.env.LB_PORT || '');
config.healthCheckPath = config.healthCheckPath || process.env.HEALTH_CHECK_PATH || '/';
config.allowedCidr = config.allowedCidr || process.env.ALLOWED_CIDR || '0.0.0.0/0';
config.environment = config.environment || {};
config.secrets = config.secrets || {};
config.logGroupName = config.logGroupName || process.env.LOG_GROUP_NAME;
config.logRetentionDays = config.logRetentionDays || parseInt(process.env.LOG_RETENTION_DAYS || '7');
config.enableAutoScaling = config.enableAutoScaling || process.env.ENABLE_AUTO_SCALING === 'true';
config.minCapacity = config.minCapacity || parseInt(process.env.MIN_CAPACITY || '1');
config.maxCapacity = config.maxCapacity || parseInt(process.env.MAX_CAPACITY || '3');
config.targetCpuUtilization = config.targetCpuUtilization || parseInt(process.env.TARGET_CPU_UTILIZATION || '70');
config.targetMemoryUtilization = config.targetMemoryUtilization || parseInt(process.env.TARGET_MEMORY_UTILIZATION || '70');
config.taskExecutionRoleArn = config.taskExecutionRoleArn || process.env.TASK_EXECUTION_ROLE_ARN;
config.taskRoleArn = config.taskRoleArn || process.env.TASK_ROLE_ARN;
// Validate required parameters
const requiredParams = ['vpcId', 'subnetIds', 'clusterName', 'image', 'stackName', 'containerPort', 'lbPort'];
for (const param of requiredParams) {
    if (!config[param]) {
        console.error(`‚ùå Error: Required parameter '${param}' is missing.`);
        console.error('   Use -c parameter, values file, or set environment variable.');
        console.error('');
        console.error('Examples:');
        console.error('  cdk deploy -c vpcId=vpc-12345678 -c image=nginx:alpine');
        console.error('  cdk deploy -c valuesFile=values.yaml');
        process.exit(1);
    }
}
// Validate parameter formats
if (config.vpcId && !config.vpcId.startsWith('vpc-')) {
    console.error('‚ùå Error: Invalid VPC ID format. Must start with "vpc-"');
    process.exit(1);
}
if (config.subnetIds && Array.isArray(config.subnetIds)) {
    for (const subnetId of config.subnetIds) {
        if (!subnetId.startsWith('subnet-')) {
            console.error(`‚ùå Error: Invalid subnet ID format: ${subnetId}. Must start with "subnet-"`);
            process.exit(1);
        }
    }
}
if (config.containerPort && (config.containerPort < 1 || config.containerPort > 65535)) {
    console.error('‚ùå Error: Invalid container port. Must be between 1 and 65535');
    process.exit(1);
}
if (config.lbPort && (config.lbPort < 1 || config.lbPort > 65535)) {
    console.error('‚ùå Error: Invalid load balancer port. Must be between 1 and 65535');
    process.exit(1);
}
// Create the ECS service stack using stack name
new ecs_service_stack_1.EcsServiceStack(app, config.stackName, {
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION,
    },
    config: config,
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vYmluL2Nkay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSxtQ0FBbUM7QUFDbkMsZ0VBQTJEO0FBRzNEOzs7Ozs7Ozs7OztHQVdHO0FBRUgsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7QUFFMUIsMEJBQTBCO0FBQzFCLElBQUksTUFBTSxHQUE4QixFQUFFLENBQUM7QUFFM0MsOENBQThDO0FBQzlDLE1BQU0sVUFBVSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3hELElBQUksVUFBVSxFQUFFO0lBQ2QsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pCLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUU3QixJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUU7UUFDN0IsSUFBSTtZQUNGLE1BQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3hELE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFFbkQsSUFBSSxNQUFXLENBQUM7WUFDaEIsSUFBSTtnQkFDRixRQUFRLEdBQUcsRUFBRTtvQkFDWCxLQUFLLEtBQUs7d0JBQ1IsTUFBTSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7d0JBQzNDLE1BQU07b0JBQ1IsS0FBSyxPQUFPLENBQUM7b0JBQ2IsS0FBSyxNQUFNO3dCQUNULE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQzt3QkFDaEMsTUFBTSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxD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LGtCQUFrQjtLQUN2QztJQUNELE1BQU0sRUFBRSxNQUEwQjtDQUNuQyxDQUFDLENBQUM7QUFFSCxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXG5cbmltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBFY3NTZXJ2aWNlU3RhY2sgfSBmcm9tICcuLi9saWIvZWNzLXNlcnZpY2Utc3RhY2snO1xuaW1wb3J0IHsgRWNzU2VydmljZUNvbmZpZyB9IGZyb20gJy4uL2xpYi90eXBlcyc7XG5cbi8qKlxuICogQ0RLIEFwcCBFbnRyeSBQb2ludFxuICogXG4gKiBVc2VzIENESydzIG5hdGl2ZSBjb250ZXh0IHBhcmFtZXRlcnMgKC1jKSBmb3IgY29uZmlndXJhdGlvblxuICogXG4gKiBVc2FnZTpcbiAqICAgIyBDb250ZXh0IHBhcmFtZXRlcnMgb25seVxuICogICBjZGsgZGVwbG95IC1jIHZwY0lkPXZwYy0xMjM0NTY3OCAtYyBpbWFnZT1uZ2lueDphbHBpbmVcbiAqICAgXG4gKiAgICMgV2l0aCB2YWx1ZXMgZmlsZSAoSGVsbS1zdHlsZSlcbiAqICAgY2RrIGRlcGxveSAtYyB2YWx1ZXNGaWxlPXZhbHVlcy55YW1sXG4gKi9cblxuY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcblxuLy8gU3RhcnQgd2l0aCBlbXB0eSBjb25maWdcbmxldCBjb25maWc6IFBhcnRpYWw8RWNzU2VydmljZUNvbmZpZz4gPSB7fTtcblxuLy8gMS4gTG9hZCBmcm9tIHZhbHVlcyBmaWxlIEZJUlNUIGlmIHNwZWNpZmllZFxuY29uc3QgdmFsdWVzRmlsZSA9IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ3ZhbHVlc0ZpbGUnKTtcbmlmICh2YWx1ZXNGaWxlKSB7XG4gIGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbiAgXG4gIGlmIChmcy5leGlzdHNTeW5jKHZhbHVlc0ZpbGUpKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKHZhbHVlc0ZpbGUsICd1dGY4Jyk7XG4gICAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUodmFsdWVzRmlsZSkudG9Mb3dlckNhc2UoKTtcbiAgICAgIFxuICAgICAgbGV0IHZhbHVlczogYW55O1xuICAgICAgdHJ5IHtcbiAgICAgICAgc3dpdGNoIChleHQpIHtcbiAgICAgICAgICBjYXNlICcuanMnOlxuICAgICAgICAgICAgdmFsdWVzID0gcmVxdWlyZShwYXRoLnJlc29sdmUodmFsdWVzRmlsZSkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnLnlhbWwnOlxuICAgICAgICAgIGNhc2UgJy55bWwnOlxuICAgICAgICAgICAgY29uc3QgeWFtbCA9IHJlcXVpcmUoJ2pzLXlhbWwnKTtcbiAgICAgICAgICAgIHZhbHVlcyA9IHlhbWwubG9hZChmaWxlQ29udGVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdmFsdWVzID0gSlNPTi5wYXJzZShmaWxlQ29udGVudCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvciBwYXJzaW5nIHZhbHVlcyBmaWxlICR7dmFsdWVzRmlsZX06ICR7ZXJyb3J9YCk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gTG9hZCB2YWx1ZXMgZmlsZSBpbnRvIGNvbmZpZ1xuICAgICAgY29uZmlnID0geyAuLi5jb25maWcsIC4uLnZhbHVlcyB9O1xuICAgICAgY29uc29sZS5sb2coYPCfk4QgTG9hZGVkIHZhbHVlcyBmcm9tOiAke3ZhbHVlc0ZpbGV9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPICBXYXJuaW5nOiBGYWlsZWQgdG8gcGFyc2UgdmFsdWVzIGZpbGUgJHt2YWx1ZXNGaWxlfTogJHtlcnJvcn1gKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS53YXJuKGDimqDvuI8gIFdhcm5pbmc6IFZhbHVlcyBmaWxlIG5vdCBmb3VuZDogJHt2YWx1ZXNGaWxlfWApO1xuICB9XG59XG5cbi8vIDIuIE92ZXJyaWRlIHdpdGggY29udGV4dCBwYXJhbWV0ZXJzIChoaWdoZXN0IHByZWNlZGVuY2UpXG4vLyBPbmx5IG92ZXJyaWRlIGlmIHRoZSBjb250ZXh0IHBhcmFtZXRlciBhY3R1YWxseSBleGlzdHNcbmNvbnN0IGNvbnRleHRLZXlzID0gW1xuICAvLyBMZWdhY3kgZmxhdCBwYXJhbWV0ZXJzIChiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxuICAndnBjSWQnLCAnc3VibmV0SWRzJywgJ2NsdXN0ZXJOYW1lJywgJ2ltYWdlJywgJ3N0YWNrTmFtZScsICdkZXNpcmVkQ291bnQnLCBcbiAgJ2NwdScsICdtZW1vcnknLCAnY29udGFpbmVyUG9ydCcsICdsYlBvcnQnLCAnaGVhbHRoQ2hlY2tQYXRoJywgJ2xvYWRCYWxhbmNlckhlYWx0aENoZWNrJywgJ2FsbG93ZWRDaWRyJyxcbiAgJ2VudicsICdzZWNyZXQnLCAnbG9nR3JvdXBOYW1lJywgJ2xvZ1JldGVudGlvbkRheXMnLCAnZW5hYmxlQXV0b1NjYWxpbmcnLFxuICAnbWluQ2FwYWNpdHknLCAnbWF4Q2FwYWNpdHknLCAndGFyZ2V0Q3B1VXRpbGl6YXRpb24nLCAndGFyZ2V0TWVtb3J5VXRpbGl6YXRpb24nLFxuICAndGFza0V4ZWN1dGlvblJvbGVBcm4nLCAndGFza1JvbGVBcm4nLCAndGFza1JvbGVQZXJtaXNzaW9ucycsICd0YXNrRXhlY3V0aW9uUm9sZVBlcm1pc3Npb25zJyxcbiAgLy8gTmV3IHN0cnVjdHVyZWQgcGFyYW1ldGVycyAoRUNTIGhpZXJhcmNoeSlcbiAgJ21ldGFkYXRhJywgJ2luZnJhc3RydWN0dXJlJywgJ2NsdXN0ZXInLCAndGFza0RlZmluaXRpb24nLCAnc2VydmljZScsICdsb2FkQmFsYW5jZXInLCAnYXV0b1NjYWxpbmcnLCAnaWFtJywgJ3NlcnZpY2VEaXNjb3ZlcnknLCAnYWRkb25zJ1xuXTtcblxuY29udGV4dEtleXMuZm9yRWFjaChrZXkgPT4ge1xuICBjb25zdCBjb250ZXh0VmFsdWUgPSBhcHAubm9kZS50cnlHZXRDb250ZXh0KGtleSk7XG4gIGlmIChjb250ZXh0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIEhhbmRsZSBzcGVjaWFsIGNhc2VzXG4gICAgaWYgKGtleSA9PT0gJ3N1Ym5ldElkcycgJiYgdHlwZW9mIGNvbnRleHRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbmZpZy5zdWJuZXRJZHMgPSBjb250ZXh0VmFsdWUuc3BsaXQoJywnKTtcbiAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2VudicpIHtcbiAgICAgIGNvbmZpZy5lbnZpcm9ubWVudCA9IGNvbnRleHRWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ3NlY3JldCcpIHtcbiAgICAgIGNvbmZpZy5zZWNyZXRzID0gY29udGV4dFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnbWV0YWRhdGEnIHx8IGtleSA9PT0gJ2luZnJhc3RydWN0dXJlJyB8fCBrZXkgPT09ICdjbHVzdGVyJyB8fCBcbiAgICAgICAgICAgICAgIGtleSA9PT0gJ3Rhc2tEZWZpbml0aW9uJyB8fCBrZXkgPT09ICdzZXJ2aWNlJyB8fCBrZXkgPT09ICdsb2FkQmFsYW5jZXInIHx8IFxuICAgICAgICAgICAgICAga2V5ID09PSAnYXV0b1NjYWxpbmcnIHx8IGtleSA9PT0gJ2lhbScgfHwga2V5ID09PSAnc2VydmljZURpc2NvdmVyeScgfHwga2V5ID09PSAnYWRkb25zJykge1xuICAgICAgLy8gTmV3IHN0cnVjdHVyZWQgcGFyYW1ldGVycyAtIHRoZXNlIHdpbGwgYmUgaGFuZGxlZCBieSB0aGUgY29uZmlnIG1hcHBlclxuICAgICAgY29uZmlnW2tleSBhcyBrZXlvZiBFY3NTZXJ2aWNlQ29uZmlnXSA9IGNvbnRleHRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTGVnYWN5IGZsYXQgcGFyYW1ldGVyc1xuICAgICAgY29uZmlnW2tleSBhcyBrZXlvZiBFY3NTZXJ2aWNlQ29uZmlnXSA9IGNvbnRleHRWYWx1ZTtcbiAgICB9XG4gIH1cbn0pO1xuXG4vLyAzLiBGYWxsIGJhY2sgdG8gZW52aXJvbm1lbnQgdmFyaWFibGVzIChsb3dlc3QgcHJlY2VkZW5jZSlcbi8vIEFwcGx5IGVudmlyb25tZW50IHZhcmlhYmxlIGZhbGxiYWNrcyBkaXJlY3RseSB0byBjb25maWdcbmNvbmZpZy52cGNJZCA9IGNvbmZpZy52cGNJZCB8fCBwcm9jZXNzLmVudi5WUENfSUQgfHwgJyc7XG5jb25maWcuc3VibmV0SWRzID0gY29uZmlnLnN1Ym5ldElkcyB8fCBwcm9jZXNzLmVudi5TVUJORVRfSURTPy5zcGxpdCgnLCcpIHx8IFtdO1xuY29uZmlnLmNsdXN0ZXJOYW1lID0gY29uZmlnLmNsdXN0ZXJOYW1lIHx8IHByb2Nlc3MuZW52LkNMVVNURVJfTkFNRSB8fCAnJztcbmNvbmZpZy5pbWFnZSA9IGNvbmZpZy5pbWFnZSB8fCBwcm9jZXNzLmVudi5JTUFHRSB8fCAnJztcbmNvbmZpZy5zdGFja05hbWUgPSBjb25maWcuc3RhY2tOYW1lIHx8IHByb2Nlc3MuZW52LlNUQUNLX05BTUUgfHwgJyc7XG5jb25maWcuZGVzaXJlZENvdW50ID0gY29uZmlnLmRlc2lyZWRDb3VudCB8fCBwYXJzZUludChwcm9jZXNzLmVudi5ERVNJUkVEX0NPVU5UIHx8ICcxJyk7XG5jb25maWcuY3B1ID0gY29uZmlnLmNwdSB8fCBwYXJzZUludChwcm9jZXNzLmVudi5DUFUgfHwgJzI1NicpO1xuY29uZmlnLm1lbW9yeSA9IGNvbmZpZy5tZW1vcnkgfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTUVNT1JZIHx8ICc1MTInKTtcbmNvbmZpZy5jb250YWluZXJQb3J0ID0gY29uZmlnLmNvbnRhaW5lclBvcnQgfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuQ09OVEFJTkVSX1BPUlQgfHwgJycpO1xuY29uZmlnLmxiUG9ydCA9IGNvbmZpZy5sYlBvcnQgfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTEJfUE9SVCB8fCAnJyk7XG5jb25maWcuaGVhbHRoQ2hlY2tQYXRoID0gY29uZmlnLmhlYWx0aENoZWNrUGF0aCB8fCBwcm9jZXNzLmVudi5IRUFMVEhfQ0hFQ0tfUEFUSCB8fCAnLyc7XG5jb25maWcuYWxsb3dlZENpZHIgPSBjb25maWcuYWxsb3dlZENpZHIgfHwgcHJvY2Vzcy5lbnYuQUxMT1dFRF9DSURSIHx8ICcwLjAuMC4wLzAnO1xuY29uZmlnLmVudmlyb25tZW50ID0gY29uZmlnLmVudmlyb25tZW50IHx8IHt9O1xuY29uZmlnLnNlY3JldHMgPSBjb25maWcuc2VjcmV0cyB8fCB7fTtcbmNvbmZpZy5sb2dHcm91cE5hbWUgPSBjb25maWcubG9nR3JvdXBOYW1lIHx8IHByb2Nlc3MuZW52LkxPR19HUk9VUF9OQU1FO1xuY29uZmlnLmxvZ1JldGVudGlvbkRheXMgPSBjb25maWcubG9nUmV0ZW50aW9uRGF5cyB8fCBwYXJzZUludChwcm9jZXNzLmVudi5MT0dfUkVURU5USU9OX0RBWVMgfHwgJzcnKTtcbmNvbmZpZy5lbmFibGVBdXRvU2NhbGluZyA9IGNvbmZpZy5lbmFibGVBdXRvU2NhbGluZyB8fCBwcm9jZXNzLmVudi5FTkFCTEVfQVVUT19TQ0FMSU5HID09PSAndHJ1ZSc7XG5jb25maWcubWluQ2FwYWNpdHkgPSBjb25maWcubWluQ2FwYWNpdHkgfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTUlOX0NBUEFDSVRZIHx8ICcxJyk7XG5jb25maWcubWF4Q2FwYWNpdHkgPSBjb25maWcubWF4Q2FwYWNpdHkgfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTUFYX0NBUEFDSVRZIHx8ICczJyk7XG5jb25maWcudGFyZ2V0Q3B1VXRpbGl6YXRpb24gPSBjb25maWcudGFyZ2V0Q3B1VXRpbGl6YXRpb24gfHwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuVEFSR0VUX0NQVV9VVElMSVpBVElPTiB8fCAnNzAnKTtcbmNvbmZpZy50YXJnZXRNZW1vcnlVdGlsaXphdGlvbiA9IGNvbmZpZy50YXJnZXRNZW1vcnlVdGlsaXphdGlvbiB8fCBwYXJzZUludChwcm9jZXNzLmVudi5UQVJHRVRfTUVNT1JZX1VUSUxJWkFUSU9OIHx8ICc3MCcpO1xuY29uZmlnLnRhc2tFeGVjdXRpb25Sb2xlQXJuID0gY29uZmlnLnRhc2tFeGVjdXRpb25Sb2xlQXJuIHx8IHByb2Nlc3MuZW52LlRBU0tfRVhFQ1VUSU9OX1JPTEVfQVJOO1xuY29uZmlnLnRhc2tSb2xlQXJuID0gY29uZmlnLnRhc2tSb2xlQXJuIHx8IHByb2Nlc3MuZW52LlRBU0tfUk9MRV9BUk47XG5cbi8vIFZhbGlkYXRlIHJlcXVpcmVkIHBhcmFtZXRlcnNcbmNvbnN0IHJlcXVpcmVkUGFyYW1zID0gWyd2cGNJZCcsICdzdWJuZXRJZHMnLCAnY2x1c3Rlck5hbWUnLCAnaW1hZ2UnLCAnc3RhY2tOYW1lJywgJ2NvbnRhaW5lclBvcnQnLCAnbGJQb3J0J107XG5mb3IgKGNvbnN0IHBhcmFtIG9mIHJlcXVpcmVkUGFyYW1zKSB7XG4gIGlmICghY29uZmlnW3BhcmFtIGFzIGtleW9mIEVjc1NlcnZpY2VDb25maWddKSB7XG4gICAgY29uc29sZS5lcnJvcihg4p2MIEVycm9yOiBSZXF1aXJlZCBwYXJhbWV0ZXIgJyR7cGFyYW19JyBpcyBtaXNzaW5nLmApO1xuICAgIGNvbnNvbGUuZXJyb3IoJyAgIFVzZSAtYyBwYXJhbWV0ZXIsIHZhbHVlcyBmaWxlLCBvciBzZXQgZW52aXJvbm1lbnQgdmFyaWFibGUuJyk7XG4gICAgY29uc29sZS5lcnJvcignJyk7XG4gICAgY29uc29sZS5lcnJvcignRXhhbXBsZXM6Jyk7XG4gICAgY29uc29sZS5lcnJvcignICBjZGsgZGVwbG95IC1jIHZwY0lkPXZwYy0xMjM0NTY3OCAtYyBpbWFnZT1uZ2lueDphbHBpbmUnKTtcbiAgICBjb25zb2xlLmVycm9yKCcgIGNkayBkZXBsb3kgLWMgdmFsdWVzRmlsZT12YWx1ZXMueWFtbCcpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxufVxuXG4vLyBWYWxpZGF0ZSBwYXJhbWV0ZXIgZm9ybWF0c1xuaWYgKGNvbmZpZy52cGNJZCAmJiAhY29uZmlnLnZwY0lkLnN0YXJ0c1dpdGgoJ3ZwYy0nKSkge1xuICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3I6IEludmFsaWQgVlBDIElEIGZvcm1hdC4gTXVzdCBzdGFydCB3aXRoIFwidnBjLVwiJyk7XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn1cblxuaWYgKGNvbmZpZy5zdWJuZXRJZHMgJiYgQXJyYXkuaXNBcnJheShjb25maWcuc3VibmV0SWRzKSkge1xuICBmb3IgKGNvbnN0IHN1Ym5ldElkIG9mIGNvbmZpZy5zdWJuZXRJZHMpIHtcbiAgICBpZiAoIXN1Ym5ldElkLnN0YXJ0c1dpdGgoJ3N1Ym5ldC0nKSkge1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MIEVycm9yOiBJbnZhbGlkIHN1Ym5ldCBJRCBmb3JtYXQ6ICR7c3VibmV0SWR9LiBNdXN0IHN0YXJ0IHdpdGggXCJzdWJuZXQtXCJgKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG4gIH1cbn1cblxuaWYgKGNvbmZpZy5jb250YWluZXJQb3J0ICYmIChjb25maWcuY29udGFpbmVyUG9ydCA8IDEgfHwgY29uZmlnLmNvbnRhaW5lclBvcnQgPiA2NTUzNSkpIHtcbiAgY29uc29sZS5lcnJvcign4p2MIEVycm9yOiBJbnZhbGlkIGNvbnRhaW5lciBwb3J0LiBNdXN0IGJlIGJldHdlZW4gMSBhbmQgNjU1MzUnKTtcbiAgcHJvY2Vzcy5leGl0KDEpO1xufVxuXG5pZiAoY29uZmlnLmxiUG9ydCAmJiAoY29uZmlnLmxiUG9ydCA8IDEgfHwgY29uZmlnLmxiUG9ydCA+IDY1NTM1KSkge1xuICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3I6IEludmFsaWQgbG9hZCBiYWxhbmNlciBwb3J0LiBNdXN0IGJlIGJldHdlZW4gMSBhbmQgNjU1MzUnKTtcbiAgcHJvY2Vzcy5leGl0KDEpO1xufVxuXG4vLyBDcmVhdGUgdGhlIEVDUyBzZXJ2aWNlIHN0YWNrIHVzaW5nIHN0YWNrIG5hbWVcbm5ldyBFY3NTZXJ2aWNlU3RhY2soYXBwLCBjb25maWcuc3RhY2tOYW1lLCB7XG4gIGVudjoge1xuICAgIGFjY291bnQ6IHByb2Nlc3MuZW52LkNES19ERUZBVUxUX0FDQ09VTlQsXG4gICAgcmVnaW9uOiBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9SRUdJT04sXG4gIH0sXG4gIGNvbmZpZzogY29uZmlnIGFzIEVjc1NlcnZpY2VDb25maWcsXG59KTtcblxuYXBwLnN5bnRoKCk7ICJdfQ==